#!/bin/bash

nodered_config=~/.node-red/settings.js

if ! grep -q "module.exports.httpAdminRoot = '/nodered';" "$nodered_config" ; then
	cat << EOF >> "$nodered_config"
module.exports.httpAdminRoot = '/nodered';
module.exports.adminAuth= {
    type: "credentials",
    users: [{
        username: "admin",
        password: "$2b$08$W5LDP3eTaIYjz5iJkKVwMu9JDg3cPFMUvBypMCmYA3fpjYQlzFC4e",
        permissions: "*"
    }]
};
EOF
    echo "Changed $nodered_config."
else
	echo "No change in $nodered_config necessary."
fi

cloudcmd_config=~/.cloudcmd.json

jq '.prefix="/cloudcmd"' "$cloudcmd_config" > "$cloudcmd_config.new"
mv "$cloudcmd_config.new" "$cloudcmd_config"
